 @page
@model IndexModel
@using System.Net.Http.Headers
@using WhatsappBusiness.CloudApi
@using WhatsappBusiness.CloudApi.Configurations
@using WhatsappBusiness.CloudApi.Interfaces
@{
    ViewData["Title"] = "Home page";

    //TOKEN
    string token = "EAAZAFkpZBIDYkBO6XYkyjuZBKvHQ9FBgWMzeYDM3QKLAMDmqlFQkIrCwrqfvCaE1THu2H1STZBLxeEIivfZAR4oZAlqZBHzf7VpkTrXPpPF7GfDkLvVSLVUBFMoWqnhjiqHZBN0h5VEuRu8Elzbd6HOYn5mvEWu7v9f8mJ18RuJXBZBdFOYH13r7OyZBZBblTmTlByovKtLa7LQty9lPH7LQ2UEXXJvRDR4uFJUZAWqZCvk7ZAuAQZD";

    //TELEFONO API
    string idTelfono = "461829920345506";

    //TELEFONO A ENVIAR
    string telefono = "526441618315";

    HttpClient client = new HttpClient();



    HttpRequestMessage request = new HttpRequestMessage(HttpMethod.Post, "https://graph.facebook.com/v15.0/" + idTelfono + "/messages");

    request.Headers.Add("Authorization", "Bearer " + token);

    request.Content = new StringContent("{ \"messaging_product\": \"whatsapp\", \"to\": \"" + telefono + "\", \"type\": \"template\", \"template\": { \"name\": \"hello_world\", \"language\": { \"code\": \"en_US\" } } }");
    request.Content.Headers.ContentType = new MediaTypeHeaderValue("application/json");

    HttpResponseMessage response = await client.SendAsync(request);
    //response.EnsureSuccessStatusCode();
    string responseBody = await response.Content.ReadAsStringAsync();    

}

<div class="text-center">
    <h1 class="display-4">Welcome</h1>
    <p>Learn about <a href="https://docs.microsoft.com/aspnet/core">building Web apps with ASP.NET Core</a>.</p>
    <textarea></textarea>
</div>
